"use strict";(globalThis.webpackChunkfrontend_book=globalThis.webpackChunkfrontend_book||[]).push([[8847],{6367(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>g,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"module-1/python-agents-ros2","title":"Python Agents and ROS 2 Control","description":"Learn how to bridge Python AI agents to robot controllers using ROS 2","source":"@site/docs/module-1/python-agents-ros2.md","sourceDirName":"module-1","slug":"/module-1/python-agents-ros2","permalink":"/docs/module-1/python-agents-ros2","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-1/python-agents-ros2.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Python Agents and ROS 2 Control","description":"Learn how to bridge Python AI agents to robot controllers using ROS 2","sidebar_label":"Python Agents and ROS 2","sidebar_position":2,"keywords":["ROS 2","Python","rclpy","agents","controllers","publishers","subscribers"],"learning_outcomes":["Use rclpy to build ROS 2 nodes that interface with Python AI agents","Implement the bridge between Python AI agents and robot controllers","Create publishers, subscribers, services, and actions in ROS 2","Understand practical applications of Python agents in robotics"]},"sidebar":"tutorialSidebar","previous":{"title":"Introduction to ROS 2","permalink":"/docs/module-1/intro-to-ros2"},"next":{"title":"Humanoid Robot Modeling with URDF","permalink":"/docs/module-1/humanoid-urdf-modeling"}}');var i=s(4848),t=s(8453);const o={title:"Python Agents and ROS 2 Control",description:"Learn how to bridge Python AI agents to robot controllers using ROS 2",sidebar_label:"Python Agents and ROS 2",sidebar_position:2,keywords:["ROS 2","Python","rclpy","agents","controllers","publishers","subscribers"],learning_outcomes:["Use rclpy to build ROS 2 nodes that interface with Python AI agents","Implement the bridge between Python AI agents and robot controllers","Create publishers, subscribers, services, and actions in ROS 2","Understand practical applications of Python agents in robotics"]},a="Python Agents and ROS 2 Control",l={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Using rclpy to Build ROS 2 Nodes",id:"using-rclpy-to-build-ros-2-nodes",level:2},{value:"Basic Node Structure",id:"basic-node-structure",level:3},{value:"Creating Publishers and Subscribers",id:"creating-publishers-and-subscribers",level:3},{value:"Bridging Python AI Agents to Robot Controllers",id:"bridging-python-ai-agents-to-robot-controllers",level:2},{value:"Example: Simple Navigation Agent",id:"example-simple-navigation-agent",level:3},{value:"Publishers, Subscribers, Services, and Actions",id:"publishers-subscribers-services-and-actions",level:2},{value:"Publishers",id:"publishers",level:3},{value:"Subscribers",id:"subscribers",level:3},{value:"Services",id:"services",level:3},{value:"Actions",id:"actions",level:3},{value:"Practical Code Examples",id:"practical-code-examples",level:2},{value:"Example 1: AI Agent for Object Recognition",id:"example-1-ai-agent-for-object-recognition",level:3},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"python-agents-and-ros-2-control",children:"Python Agents and ROS 2 Control"})}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsx)(n.p,{children:"After completing this chapter, you will be able to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use rclpy to build ROS 2 nodes that interface with Python AI agents"}),"\n",(0,i.jsx)(n.li,{children:"Implement the bridge between Python AI agents and robot controllers"}),"\n",(0,i.jsx)(n.li,{children:"Create publishers, subscribers, services, and actions in ROS 2"}),"\n",(0,i.jsx)(n.li,{children:"Understand practical applications of Python agents in robotics"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#using-rclpy-to-build-ros2-nodes",children:"Using rclpy to Build ROS 2 Nodes"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#bridging-python-ai-agents-to-robot-controllers",children:"Bridging Python AI Agents to Robot Controllers"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#publishers-subscribers-services-and-actions",children:"Publishers, Subscribers, Services, and Actions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#practical-code-examples",children:"Practical Code Examples"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#summary",children:"Summary"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"using-rclpy-to-build-ros-2-nodes",children:"Using rclpy to Build ROS 2 Nodes"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"rclpy"})," is the Python client library for ROS 2, allowing Python programs to interface with the ROS 2 system. It provides the tools needed to create nodes, publish and subscribe to topics, and provide or use services."]}),"\n",(0,i.jsx)(n.h3,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass PythonAgentNode(Node):\n    def __init__(self):\n        super().__init__('python_agent_node')\n        self.get_logger().info('Python Agent Node has been started')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = PythonAgentNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"creating-publishers-and-subscribers",children:"Creating Publishers and Subscribers"}),"\n",(0,i.jsx)(n.p,{children:"The most common communication pattern in ROS 2 involves publishers and subscribers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass AgentController(Node):\n    def __init__(self):\n        super().__init__('agent_controller')\n\n        # Create a publisher\n        self.publisher = self.create_publisher(String, 'agent_commands', 10)\n\n        # Create a subscriber\n        self.subscription = self.create_subscription(\n            String,\n            'sensor_data',\n            self.sensor_callback,\n            10\n        )\n\n        # Timer for periodic publishing\n        self.timer = self.create_timer(0.5, self.publish_command)\n        self.i = 0\n\n    def sensor_callback(self, msg):\n        self.get_logger().info(f'Received sensor data: {msg.data}')\n        # Process sensor data and make decisions\n        self.process_sensor_data(msg.data)\n\n    def publish_command(self):\n        msg = String()\n        msg.data = f'Command from agent: {self.i}'\n        self.publisher.publish(msg)\n        self.get_logger().info(f'Publishing: {msg.data}')\n        self.i += 1\n\n    def process_sensor_data(self, data):\n        # Implement AI agent logic here\n        self.get_logger().info(f'Agent processing: {data}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    agent_controller = AgentController()\n\n    try:\n        rclpy.spin(agent_controller)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        agent_controller.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"bridging-python-ai-agents-to-robot-controllers",children:"Bridging Python AI Agents to Robot Controllers"}),"\n",(0,i.jsx)(n.p,{children:"One of the key applications of ROS 2 is bridging high-level AI agents with low-level robot controllers. This involves:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data Flow"}),": Sensor data flows from robot to AI agent"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Decision Making"}),": AI agent processes data and makes decisions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Command Execution"}),": Commands flow from AI agent to robot controllers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Feedback Loop"}),": Continuous loop for real-time control"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-simple-navigation-agent",children:"Example: Simple Navigation Agent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import LaserScan\nfrom geometry_msgs.msg import Twist\nimport numpy as np\n\nclass NavigationAgent(Node):\n    def __init__(self):\n        super().__init__('navigation_agent')\n\n        # Subscriber for laser scan data\n        self.scan_sub = self.create_subscription(\n            LaserScan,\n            'scan',\n            self.scan_callback,\n            10\n        )\n\n        # Publisher for velocity commands\n        self.cmd_pub = self.create_publisher(Twist, 'cmd_vel', 10)\n\n        self.safe_distance = 1.0  # meters\n\n    def scan_callback(self, msg):\n        # Process laser scan data\n        min_distance = min(msg.ranges)\n\n        # Simple navigation logic\n        cmd = Twist()\n\n        if min_distance > self.safe_distance:\n            # Move forward\n            cmd.linear.x = 0.5\n            cmd.angular.z = 0.0\n        else:\n            # Stop and turn\n            cmd.linear.x = 0.0\n            cmd.angular.z = 0.5\n\n        # Publish command to robot controller\n        self.cmd_pub.publish(cmd)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    nav_agent = NavigationAgent()\n\n    try:\n        rclpy.spin(nav_agent)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        nav_agent.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"publishers-subscribers-services-and-actions",children:"Publishers, Subscribers, Services, and Actions"}),"\n",(0,i.jsx)(n.h3,{id:"publishers",children:"Publishers"}),"\n",(0,i.jsx)(n.p,{children:"Publishers send data to topics. They are asynchronous and follow a fire-and-forget pattern:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Creating a publisher\npublisher = self.create_publisher(String, 'topic_name', queue_size)\n\n# Publishing a message\nmsg = String()\nmsg.data = 'Hello from Python agent'\npublisher.publish(msg)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"subscribers",children:"Subscribers"}),"\n",(0,i.jsx)(n.p,{children:"Subscribers receive data from topics:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Creating a subscriber\nsubscription = self.create_subscription(\n    MessageType,\n    'topic_name',\n    callback_function,\n    queue_size\n)\n\n# Callback function\ndef callback_function(self, msg):\n    # Process received message\n    self.get_logger().info(f'Received: {msg.data}')\n"})}),"\n",(0,i.jsx)(n.h3,{id:"services",children:"Services"}),"\n",(0,i.jsx)(n.p,{children:"Services provide synchronous request/response communication:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Creating a service server\nself.srv = self.create_service(RequestType, 'service_name', self.service_callback)\n\ndef service_callback(self, request, response):\n    # Process request and return response\n    response.result = f'Processed: {request.input}'\n    return response\n\n# Using a service client\nclient = self.create_client(RequestType, 'service_name')\n"})}),"\n",(0,i.jsx)(n.h3,{id:"actions",children:"Actions"}),"\n",(0,i.jsx)(n.p,{children:"Actions are used for long-running tasks with feedback:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Creating an action server\nfrom rclpy.action import ActionServer\nfrom example_interfaces.action import Fibonacci\n\nself._action_server = ActionServer(\n    self,\n    Fibonacci,\n    'fibonacci',\n    self.execute_callback\n)\n\ndef execute_callback(self, goal_handle):\n    feedback_msg = Fibonacci.Feedback()\n    feedback_msg.sequence = [0, 1]\n\n    for i in range(1, goal_handle.request.order):\n        feedback_msg.sequence.append(\n            feedback_msg.sequence[i] + feedback_msg.sequence[i-1])\n        goal_handle.publish_feedback(feedback_msg)\n\n    goal_handle.succeed()\n    result = Fibonacci.Result()\n    result.sequence = feedback_msg.sequence\n    return result\n"})}),"\n",(0,i.jsx)(n.h2,{id:"practical-code-examples",children:"Practical Code Examples"}),"\n",(0,i.jsx)(n.h3,{id:"example-1-ai-agent-for-object-recognition",children:"Example 1: AI Agent for Object Recognition"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Image\nfrom std_msgs.msg import String\nfrom cv_bridge import CvBridge\nimport cv2\n\nclass ObjectRecognitionAgent(Node):\n    def __init__(self):\n        super().__init__('object_recognition_agent')\n\n        self.bridge = CvBridge()\n        self.image_sub = self.create_subscription(\n            Image,\n            'camera/image_raw',\n            self.image_callback,\n            10\n        )\n        self.result_pub = self.create_publisher(String, 'object_detection_result', 10)\n\n    def image_callback(self, msg):\n        try:\n            # Convert ROS image to OpenCV image\n            cv_image = self.bridge.imgmsg_to_cv2(msg, \"bgr8\")\n\n            # Perform object recognition (simplified example)\n            result = self.recognize_objects(cv_image)\n\n            # Publish result\n            result_msg = String()\n            result_msg.data = result\n            self.result_pub.publish(result_msg)\n\n        except Exception as e:\n            self.get_logger().error(f'Error processing image: {e}')\n\n    def recognize_objects(self, image):\n        # Simplified object recognition logic\n        # In practice, you would use a trained model like YOLO or similar\n        height, width, _ = image.shape\n\n        # Return a simple result for demonstration\n        return f\"Detected objects in {width}x{height} image\"\n\ndef main(args=None):\n    rclpy.init(args=args)\n    agent = ObjectRecognitionAgent()\n\n    try:\n        rclpy.spin(agent)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        agent.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"This chapter has covered how to bridge Python AI agents to robot controllers using ROS 2. You've learned to use rclpy to create nodes, implement publishers and subscribers, and work with services and actions. These concepts form the foundation for creating intelligent robotic systems that can interact with the physical world through ROS 2."}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsx)(n.p,{children:"Continue with the next chapter in this module:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/module-1/intro-to-ros2",children:"Previous: Introduction to ROS 2"})," - Review fundamental ROS 2 concepts"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/module-1/humanoid-urdf-modeling",children:"Next: Humanoid Robot Modeling with URDF"})," - Learn how to model humanoid robots using URDF"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>a});var r=s(6540);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);